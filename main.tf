
# This file is autogenerated. Do not edit this file directly.
# Please make changes to the application template instead.

module "pimlico-api-secret" {
  source      = "github.com/GoogleCloudPlatform/terraform-google-secret-manager//modules/simple-secret?ref=v0.9.0"
  project_id  = "alpha-orion"
  name        = "pimlico-api-key"
  # CRITICAL SECURITY FIX: Use Secret Manager to inject the actual secret value
  # Do not hardcode secrets in Terraform
  secret_data = var.pimlico_api_key
  automatic_replication = {
    kms_key_name = "projects/alpha-orion/locations/us-central1/keyRings/flash-loan-keyring/cryptoKeys/flash-loan-key"
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "user-api-service" {
  source                        = "github.com/GoogleCloudPlatform/terraform-google-cloud-run//modules/v2?ref=v0.21.6"
  project_id                    = "alpha-orion"
  location                      = "us-central1"
  service_name                  = "user-api-service"
"container_image" = "us-docker.pkg.dev/alpha-orion/${var.artifact_registry_repo}/user-api-service:${lookup(var.image_versions, \"user-api-service\", \"latest\")}"
  gpu_zonal_redundancy_disabled = false
  service_account_project_roles = concat(["roles/secretmanager.secretAccessor"], ["roles/alloydb.admin"], ["roles/redis.editor"])
  ingress                       = "INGRESS_TRAFFIC_INTERNAL_LOAD_BALANCER"
  vpc_access = {
    egress = "ALL_TRAFFIC"
    network_interfaces = {
      network    = "default"
      subnetwork = "default"
    }
  }
  cloud_run_deletion_protection = false
  enable_prometheus_sidecar     = true
  volumes                       = []
  service_scaling = {
    min_instance_count = 0
  }
  template_scaling = {
    max_instance_count = 10
    min_instance_count = 1
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "db-secret" {
  source      = "github.com/GoogleCloudPlatform/terraform-google-secret-manager//modules/simple-secret?ref=v0.9.0"
  project_id  = "alpha-orion"
  name        = "db-credentials"
  # CRITICAL SECURITY FIX: Use Secret Manager reference
  secret_data = var.db_password
  automatic_replication = {
    kms_key_name = "projects/alpha-orion/locations/us-central1/keyRings/flash-loan-keyring/cryptoKeys/flash-loan-key"
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "scanner-service-data-analysis" {
  source                        = "github.com/GoogleCloudPlatform/terraform-google-cloud-run//modules/v2?ref=v0.21.6"
  project_id                    = "alpha-orion"
  location                      = "us-central1"
  service_name                  = "eye-scanner-us"
  description                   = "Responsible for data collection and opportunity identification in the US region."
"container_image" = "us-docker.pkg.dev/alpha-orion/${var.artifact_registry_repo}/eye-scanner-us:${lookup(var.image_versions, \"eye-scanner-us\", \"latest\")}"
  gpu_zonal_redundancy_disabled = false
  service_account_project_roles = concat(["roles/pubsub.publisher", "roles/pubsub.subscriber", "roles/run.invoker"], ["roles/secretmanager.secretAccessor"], ["roles/alloydb.admin"], ["roles/redis.editor"], ["roles/bigquery.dataEditor"])
  ingress                       = "INGRESS_TRAFFIC_INTERNAL_ONLY"
  vpc_access = {
    egress = "ALL_TRAFFIC"
    network_interfaces = {
      network    = "default"
      subnetwork = "default"
    }
  }
  cloud_run_deletion_protection = false
  enable_prometheus_sidecar     = true
  volumes                       = []
  service_scaling = {
    min_instance_count = 0
  }
  template_scaling = {
    max_instance_count = 10
    min_instance_count = 1
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "orchestrator-service" {
  source                        = "github.com/GoogleCloudPlatform/terraform-google-cloud-run//modules/v2?ref=v0.21.6"
  project_id                    = "alpha-orion"
  location                      = "us-central1"
  service_name                  = "brain-orchestrator-us"
  description                   = "Manages workflow and orchestrates strategies in the US region."
"container_image" = "us-docker.pkg.dev/alpha-orion/${var.artifact_registry_repo}/brain-orchestrator-us:${lookup(var.image_versions, \"brain-orchestrator-us\", \"latest\")}"
  gpu_zonal_redundancy_disabled = false
  service_account_project_roles = concat(["roles/pubsub.publisher", "roles/pubsub.subscriber", "roles/run.invoker"], ["roles/pubsub.publisher", "roles/pubsub.subscriber", "roles/run.invoker"], ["roles/secretmanager.secretAccessor"], ["roles/secretmanager.secretAccessor"], ["roles/alloydb.admin"], ["roles/redis.editor"], ["roles/run.invoker"], ["roles/run.invoker"])
  ingress                       = "INGRESS_TRAFFIC_INTERNAL_ONLY"
  vpc_access = {
    egress = "ALL_TRAFFIC"
    network_interfaces = {
      network    = "default"
      subnetwork = "default"
    }
  }
  cloud_run_deletion_protection = false
  enable_prometheus_sidecar     = true
  volumes                       = []
  service_scaling = {
    min_instance_count = 0
  }
  template_scaling = {
    max_instance_count = 10
    min_instance_count = 1
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "ai-optimizer-service" {
  source                        = "github.com/GoogleCloudPlatform/terraform-google-cloud-run//modules/v2?ref=v0.21.6"
  project_id                    = "alpha-orion"
  location                      = "us-central1"
  service_name                  = "brain-ai-optimizer-us"
  description                   = "Continuously optimizes AI models for performance in the US region."
"container_image" = "us-docker.pkg.dev/alpha-orion/${var.artifact_registry_repo}/brain-ai-optimizer-us:${lookup(var.image_versions, \"brain-ai-optimizer-us\", \"latest\")}"
  gpu_zonal_redundancy_disabled = false
  service_account_project_roles = concat(["roles/aiplatform.user"], ["roles/secretmanager.secretAccessor"], ["roles/alloydb.admin"], ["roles/redis.editor"])
  ingress                       = "INGRESS_TRAFFIC_INTERNAL_ONLY"
  vpc_access = {
    egress = "ALL_TRAFFIC"
    network_interfaces = {
      network    = "default"
      subnetwork = "default"
    }
  }
  cloud_run_deletion_protection = false
  enable_prometheus_sidecar     = true
  volumes                       = []
  service_scaling = {
    min_instance_count = 0
  }
  service_labels = {
    vertex_ai_apis_vertex-ai = "true"
  }
  template_scaling = {
    max_instance_count = 10
    min_instance_count = 1
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "dashboard-frontend" {
  source                        = "github.com/GoogleCloudPlatform/terraform-google-cloud-run//modules/v2?ref=v0.21.6"
  project_id                    = "alpha-orion"
  location                      = "us-central1"
  service_name                  = "flash-loan-dashboard"
"container_image" = "us-docker.pkg.dev/alpha-orion/${var.artifact_registry_repo}/flash-loan-dashboard:${lookup(var.image_versions, \"flash-loan-dashboard\", \"latest\")}"
  gpu_zonal_redundancy_disabled = false
  service_account_project_roles = concat(["roles/secretmanager.secretAccessor"], ["roles/alloydb.admin"], ["roles/redis.editor"])
  ingress                       = "INGRESS_TRAFFIC_INTERNAL_LOAD_BALANCER"
  vpc_access = {
    egress = "ALL_TRAFFIC"
    network_interfaces = {
      network    = "default"
      subnetwork = "default"
    }
  }
  cloud_run_deletion_protection = false
  enable_prometheus_sidecar     = true
  volumes                       = []
  service_scaling = {
    min_instance_count = 0
  }
  template_scaling = {
    max_instance_count = 10
    min_instance_count = 1
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "withdrawal-service" {
  source                        = "github.com/GoogleCloudPlatform/terraform-google-cloud-run//modules/v2?ref=v0.21.6"
  project_id                    = "alpha-orion"
  location                      = "us-central1"
  service_name                  = "withdrawal-service"
"container_image" = "us-docker.pkg.dev/alpha-orion/${var.artifact_registry_repo}/withdrawal-service:${lookup(var.image_versions, \"withdrawal-service\", \"latest\")}"
  gpu_zonal_redundancy_disabled = false
  service_account_project_roles = concat(["roles/secretmanager.secretAccessor"], ["roles/secretmanager.secretAccessor"], ["roles/alloydb.admin"], ["roles/redis.editor"])
  ingress                       = "INGRESS_TRAFFIC_INTERNAL_ONLY"
  vpc_access = {
    egress = "ALL_TRAFFIC"
    network_interfaces = {
      network    = "default"
      subnetwork = "default"
    }
  }
  cloud_run_deletion_protection = false
  enable_prometheus_sidecar     = true
  volumes                       = []
  service_scaling = {
    min_instance_count = 0
  }
  template_scaling = {
    max_instance_count = 10
    min_instance_count = 1
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "vertex-ai-apis" {
  source        = "github.com/terraform-google-modules/terraform-google-project-factory//modules/project_services?ref=v18.0.0"
  project_id    = "alpha-orion"
  activate_apis = ["aiplatform.googleapis.com"]
  depends_on    = [module.project-services-alpha-orion, module.project-services-billing-project]
}
# Dead Letter Queue for failed messages
resource "google_pubsub_topic" "dead_letter" {
  project = "alpha-orion"
  name   = "dead-letter-queue"
}

module "scanner-output-topic" {
  source             = "github.com/terraform-google-modules/terraform-google-pubsub?ref=v8.3.2"
  project_id         = "alpha-orion"
  topic              = "raw-opportunities"
  dead_letter_policy = {
    dead_letter_topic = google_pubsub_topic.dead_letter.id
    max_delivery_attempts = 5
  }
  retry_policy = {
    minimum_backoff = "10s"
    maximum_backoff = "600s"
  }
  push_subscriptions = concat([{"name" = module.scanner-service-data-analysis.apphub_service_uri.service_id, "oidc_service_account_email" = module.scanner-service-data-analysis.service_account_id.email, "push_endpoint" = module.scanner-service-data-analysis.service_uri}], [{"oidc_service_account_email" = module.orchestrator-service.service_account_id.email, "push_endpoint" = module.orchestrator-service.service_uri, "name" = module.orchestrator-service.apphub_service_uri.service_id}])
  pull_subscriptions = concat([{"name" = module.scanner-service-data-analysis.service_name, "service_account" = module.scanner-service-data-analysis.service_account_id.email}], [{"service_account" = module.orchestrator-service.service_account_id.email, "name" = module.orchestrator-service.service_name}])
  depends_on         = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "execution-request-topic" {
  source     = "github.com/terraform-google-modules/terraform-google-pubsub?ref=v8.3.2"
  project_id = "alpha-orion"
  topic      = "flash-loan-execution-requests"
  dead_letter_policy = {
    dead_letter_topic = google_pubsub_topic.dead_letter.id
    max_delivery_attempts = 3  # Fewer retries for financial transactions
  }
  retry_policy = {
    minimum_backoff = "5s"
    maximum_backoff = "300s"
  }
  push_subscriptions = [{
    name                       = module.orchestrator-service.apphub_service_uri.service_id
    oidc_service_account_email = module.orchestrator-service.service_account_id.email
    push_endpoint              = module.orchestrator-service.service_uri
  }]
  pull_subscriptions = [{
    name            = module.orchestrator-service.service_name
    service_account = module.orchestrator-service.service_account_id.email
  }]
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "withdrawal-wallet-secret" {
  source      = "github.com/GoogleCloudPlatform/terraform-google-secret-manager//modules/simple-secret?ref=v0.9.0"
  project_id  = "alpha-orion"
  name        = "withdrawal-wallet-keys"
  # CRITICAL SECURITY FIX: Use Secret Manager reference
  secret_data = var.db_password
  automatic_replication = {
    kms_key_name = "projects/alpha-orion/locations/us-central1/keyRings/flash-loan-keyring/cryptoKeys/flash-loan-key"
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "ai-terminal-frontend" {
  source                        = "github.com/GoogleCloudPlatform/terraform-google-cloud-run//modules/v2?ref=v0.21.6"
  project_id                    = "alpha-orion"
  location                      = "us-central1"
  service_name                  = "ai-terminal-frontend"
"container_image" = "us-docker.pkg.dev/alpha-orion/${var.artifact_registry_repo}/ai-terminal-frontend:${lookup(var.image_versions, \"ai-terminal-frontend\", \"latest\")}"
  gpu_zonal_redundancy_disabled = false
  service_account_project_roles = concat(["roles/secretmanager.secretAccessor"], ["roles/alloydb.admin"], ["roles/redis.editor"])
  ingress                       = "INGRESS_TRAFFIC_INTERNAL_LOAD_BALANCER"
  vpc_access = {
    egress = "ALL_TRAFFIC"
    network_interfaces = {
      network    = "default"
      subnetwork = "default"
    }
  }
  cloud_run_deletion_protection = false
  enable_prometheus_sidecar     = true
  volumes                       = []
  service_scaling = {
    min_instance_count = 0
  }
  template_scaling = {
    max_instance_count = 10
    min_instance_count = 1
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "ai-agent-service" {
  source                        = "github.com/GoogleCloudPlatform/terraform-google-cloud-run//modules/v2?ref=v0.21.6"
  project_id                    = "alpha-orion"
  location                      = "us-central1"
  service_name                  = "ai-agent-service"
"container_image" = "us-docker.pkg.dev/alpha-orion/${var.artifact_registry_repo}/ai-agent-service:${lookup(var.image_versions, \"ai-agent-service\", \"latest\")}"
  gpu_zonal_redundancy_disabled = false
  service_account_project_roles = concat(["roles/aiplatform.user"], ["roles/secretmanager.secretAccessor"], ["roles/alloydb.admin"], ["roles/redis.editor"])
  ingress                       = "INGRESS_TRAFFIC_INTERNAL_ONLY"
  vpc_access = {
    egress = "ALL_TRAFFIC"
    network_interfaces = {
      network    = "default"
      subnetwork = "default"
    }
  }
  cloud_run_deletion_protection = false
  enable_prometheus_sidecar     = true
  volumes                       = []
  service_scaling = {
    min_instance_count = 0
  }
  service_labels = {
    vertex_ai_apis_vertex-ai = "true"
  }
  template_scaling = {
    max_instance_count = 10
    min_instance_count = 1
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "benchmarking-scraper-service" {
  source                        = "github.com/GoogleCloudPlatform/terraform-google-cloud-run//modules/v2?ref=v0.21.6"
  project_id                    = "alpha-orion"
  location                      = "us-central1"
  service_name                  = "benchmarking-scraper-service"
"container_image" = "us-docker.pkg.dev/alpha-orion/${var.artifact_registry_repo}/benchmarking-scraper-service:${lookup(var.image_versions, \"benchmarking-scraper-service\", \"latest\")}"
  gpu_zonal_redundancy_disabled = false
  service_account_project_roles = concat(["roles/secretmanager.secretAccessor"], ["roles/alloydb.admin"], ["roles/redis.editor"])
  ingress                       = "INGRESS_TRAFFIC_INTERNAL_ONLY"
  vpc_access = {
    egress = "ALL_TRAFFIC"
    network_interfaces = {
      network    = "default"
      subnetwork = "default"
    }
  }
  cloud_run_deletion_protection = false
  enable_prometheus_sidecar     = true
  volumes                       = []
  service_scaling = {
    min_instance_count = 0
  }
  template_scaling = {
    max_instance_count = 10
    min_instance_count = 1
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "strategy-engine-service" {
  source                        = "github.com/GoogleCloudPlatform/terraform-google-cloud-run//modules/v2?ref=v0.21.6"
  project_id                    = "alpha-orion"
  location                      = "us-central1"
  service_name                  = "brain-strategy-engine-us"
  description                   = "Selects and executes optimal strategies in the US region."
"container_image" = "us-docker.pkg.dev/alpha-orion/${var.artifact_registry_repo}/brain-strategy-engine-us:${lookup(var.image_versions, \"brain-strategy-engine-us\", \"latest\")}"
  gpu_zonal_redundancy_disabled = false
  service_account_project_roles = concat(["roles/secretmanager.secretAccessor"], ["roles/alloydb.admin"], ["roles/redis.editor"])
  ingress                       = "INGRESS_TRAFFIC_INTERNAL_ONLY"
  vpc_access = {
    egress = "ALL_TRAFFIC"
    network_interfaces = {
      network    = "default"
      subnetwork = "default"
    }
  }
  cloud_run_deletion_protection = false
  enable_prometheus_sidecar     = true
  volumes                       = []
  service_scaling = {
    min_instance_count = 0
  }
  template_scaling = {
    max_instance_count = 10
    min_instance_count = 1
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "flash-loan-lb-global-lb-frontend" {
  source                          = "github.com/terraform-google-modules/terraform-google-lb-http//modules/frontend?ref=v13.2.0"
  name                            = "flash-loan-app-frontend"
  project_id                      = "alpha-orion"
  create_address                  = true
  url_map_input                   = module.flash-loan-lb-global-lb-backend.backend_service_info
  ssl                             = true
  managed_ssl_certificate_domains = ["flashloan.example.com"]
  depends_on                      = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "flash-loan-lb-global-lb-backend" {
  source                  = "github.com/terraform-google-modules/terraform-google-lb-http//modules/backend?ref=v13.2.0"
  name                    = "flash-loan-app-backend"
  project_id              = "alpha-orion"
  load_balancing_scheme   = "EXTERNAL_MANAGED"
  protocol                = "HTTP"
  enable_cdn              = true
  serverless_neg_backends = concat([{"region" = module.dashboard-frontend.location, "service_name" = module.dashboard-frontend.service_name, "service_version" = "", "type" = "cloud-run"}], [{"service_name" = module.dashboard-frontend-eu.service_name, "service_version" = "", "type" = "cloud-run", "region" = module.dashboard-frontend-eu.location}], [{"region" = module.user-api-service.location, "service_name" = module.user-api-service.service_name, "service_version" = "", "type" = "cloud-run"}], [{"service_name" = module.user-api-service-eu.service_name, "service_version" = "", "type" = "cloud-run", "region" = module.user-api-service-eu.location}], [{"region" = module.ai-terminal-frontend.location, "service_name" = module.ai-terminal-frontend.service_name, "service_version" = "", "type" = "cloud-run"}], [{"service_name" = module.ai-terminal-frontend-eu.service_name, "service_version" = "", "type" = "cloud-run", "region" = module.ai-terminal-frontend-eu.location}])
  security_policy         = "projects/alpha-orion/global/securityPolicies/flash-loan-security-policy"
  depends_on              = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "pimlico-api-secret-eu" {
  source      = "github.com/GoogleCloudPlatform/terraform-google-secret-manager//modules/simple-secret?ref=v0.9.0"
  project_id  = "alpha-orion"
  name        = "pimlico-api-key-eu"
  secret_data = var.pimlico_api_key
  automatic_replication = {
    kms_key_name = "projects/alpha-orion/locations/europe-west1/keyRings/flash-loan-keyring-eu/cryptoKeys/flash-loan-key-eu"
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "db-secret-eu" {
  source      = "github.com/GoogleCloudPlatform/terraform-google-secret-manager//modules/simple-secret?ref=v0.9.0"
  project_id  = "alpha-orion"
  name        = "db-credentials-eu"
  secret_data = "YOUR_GENERATED_DB_PASSWORD_HERE_EU"
  automatic_replication = {
    kms_key_name = "projects/alpha-orion/locations/europe-west1/keyRings/flash-loan-keyring-eu/cryptoKeys/flash-loan-key-eu"
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "withdrawal-wallet-secret-eu" {
  source      = "github.com/GoogleCloudPlatform/terraform-google-secret-manager//modules/simple-secret?ref=v0.9.0"
  project_id  = "alpha-orion"
  name        = "withdrawal-wallet-keys-eu"
  secret_data = "YOUR_WITHDRAWAL_WALLET_KEYS_HERE_EU"
  automatic_replication = {
    kms_key_name = "projects/alpha-orion/locations/europe-west1/keyRings/flash-loan-keyring-eu/cryptoKeys/flash-loan-key-eu"
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "scanner-output-topic-eu" {
  source             = "github.com/terraform-google-modules/terraform-google-pubsub?ref=v8.3.2"
  project_id         = "alpha-orion"
  topic              = "raw-opportunities-eu"
  push_subscriptions = concat([{"oidc_service_account_email" = module.scanner-service-data-analysis-eu.service_account_id.email, "push_endpoint" = module.scanner-service-data-analysis-eu.service_uri, "name" = module.scanner-service-data-analysis-eu.apphub_service_uri.service_id}], [{"push_endpoint" = module.orchestrator-service-eu.service_uri, "name" = module.orchestrator-service-eu.apphub_service_uri.service_id, "oidc_service_account_email" = module.orchestrator-service-eu.service_account_id.email}])
  pull_subscriptions = concat([{"name" = module.scanner-service-data-analysis-eu.service_name, "service_account" = module.scanner-service-data-analysis-eu.service_account_id.email}], [{"name" = module.orchestrator-service-eu.service_name, "service_account" = module.orchestrator-service-eu.service_account_id.email}])
  depends_on         = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "execution-request-topic-eu" {
  source     = "github.com/terraform-google-modules/terraform-google-pubsub?ref=v8.3.2"
  project_id = "alpha-orion"
  topic      = "flash-loan-execution-requests-eu"
  push_subscriptions = [{
    name                       = module.orchestrator-service-eu.apphub_service_uri.service_id
    oidc_service_account_email = module.orchestrator-service-eu.service_account_id.email
    push_endpoint              = module.orchestrator-service-eu.service_uri
  }]
  pull_subscriptions = [{
    name            = module.orchestrator-service-eu.service_name
    service_account = module.orchestrator-service-eu.service_account_id.email
  }]
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "user-api-service-eu" {
  source                        = "github.com/GoogleCloudPlatform/terraform-google-cloud-run//modules/v2?ref=v0.21.6"
  project_id                    = "alpha-orion"
  location                      = "europe-west1"
  service_name                  = "user-api-service-eu"
"container_image" = "us-docker.pkg.dev/alpha-orion/${var.artifact_registry_repo}/user-api-service-eu:${lookup(var.image_versions, \"user-api-service-eu\", \"latest\")}"
  gpu_zonal_redundancy_disabled = false
  service_account_project_roles = concat(["roles/secretmanager.secretAccessor"], ["roles/alloydb.admin"], ["roles/redis.editor"])
  ingress                       = "INGRESS_TRAFFIC_INTERNAL_LOAD_BALANCER"
  vpc_access = {
    egress = "ALL_TRAFFIC"
    network_interfaces = {
      network    = "default"
      subnetwork = "default"
    }
  }
  cloud_run_deletion_protection = false
  enable_prometheus_sidecar     = true
  volumes                       = []
  service_scaling = {
    min_instance_count = 0
  }
  template_scaling = {
    max_instance_count = 10
    min_instance_count = 1
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "scanner-service-data-analysis-eu" {
  source                        = "github.com/GoogleCloudPlatform/terraform-google-cloud-run//modules/v2?ref=v0.21.6"
  project_id                    = "alpha-orion"
  location                      = "europe-west1"
  service_name                  = "eye-scanner-eu"
  description                   = "Responsible for data collection and opportunity identification in the EU region."
"container_image" = "us-docker.pkg.dev/alpha-orion/${var.artifact_registry_repo}/eye-scanner-eu:${lookup(var.image_versions, \"eye-scanner-eu\", \"latest\")}"
  gpu_zonal_redundancy_disabled = false
  service_account_project_roles = concat(["roles/pubsub.publisher", "roles/pubsub.subscriber", "roles/run.invoker"], ["roles/secretmanager.secretAccessor"], ["roles/alloydb.admin"], ["roles/redis.editor"])
  ingress                       = "INGRESS_TRAFFIC_INTERNAL_ONLY"
  vpc_access = {
    egress = "ALL_TRAFFIC"
    network_interfaces = {
      network    = "default"
      subnetwork = "default"
    }
  }
  cloud_run_deletion_protection = false
  enable_prometheus_sidecar     = true
  volumes                       = []
  service_scaling = {
    min_instance_count = 0
  }
  template_scaling = {
    max_instance_count = 10
    min_instance_count = 1
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "orchestrator-service-eu" {
  source                        = "github.com/GoogleCloudPlatform/terraform-google-cloud-run//modules/v2?ref=v0.21.6"
  project_id                    = "alpha-orion"
  location                      = "europe-west1"
  service_name                  = "brain-orchestrator-eu"
  description                   = "Manages workflow and orchestrates strategies in the EU region."
"container_image" = "us-docker.pkg.dev/alpha-orion/${var.artifact_registry_repo}/brain-orchestrator-eu:${lookup(var.image_versions, \"brain-orchestrator-eu\", \"latest\")}"
  gpu_zonal_redundancy_disabled = false
  service_account_project_roles = concat(["roles/pubsub.publisher", "roles/pubsub.subscriber", "roles/run.invoker"], ["roles/pubsub.publisher", "roles/pubsub.subscriber", "roles/run.invoker"], ["roles/secretmanager.secretAccessor"], ["roles/secretmanager.secretAccessor"], ["roles/alloydb.admin"], ["roles/redis.editor"], ["roles/run.invoker"], ["roles/run.invoker"])
  ingress                       = "INGRESS_TRAFFIC_INTERNAL_ONLY"
  vpc_access = {
    egress = "ALL_TRAFFIC"
    network_interfaces = {
      network    = "default"
      subnetwork = "default"
    }
  }
  cloud_run_deletion_protection = false
  enable_prometheus_sidecar     = true
  volumes                       = []
  service_scaling = {
    min_instance_count = 0
  }
  template_scaling = {
    max_instance_count = 10
    min_instance_count = 1
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "ai-optimizer-service-eu" {
  source                        = "github.com/GoogleCloudPlatform/terraform-google-cloud-run//modules/v2?ref=v0.21.6"
  project_id                    = "alpha-orion"
  location                      = "europe-west1"
  service_name                  = "brain-ai-optimizer-eu"
  description                   = "Continuously optimizes AI models for performance in the EU region."
"container_image" = "us-docker.pkg.dev/alpha-orion/${var.artifact_registry_repo}/brain-ai-optimizer-eu:${lookup(var.image_versions, \"brain-ai-optimizer-eu\", \"latest\")}"
  gpu_zonal_redundancy_disabled = false
  service_account_project_roles = concat(["roles/aiplatform.user"], ["roles/secretmanager.secretAccessor"], ["roles/alloydb.admin"], ["roles/redis.editor"])
  ingress                       = "INGRESS_TRAFFIC_INTERNAL_ONLY"
  vpc_access = {
    egress = "ALL_TRAFFIC"
    network_interfaces = {
      network    = "default"
      subnetwork = "default"
    }
  }
  cloud_run_deletion_protection = false
  enable_prometheus_sidecar     = true
  volumes                       = []
  service_scaling = {
    min_instance_count = 0
  }
  service_labels = {
    vertex_ai_apis_vertex-ai = "true"
  }
  template_scaling = {
    max_instance_count = 10
    min_instance_count = 1
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "dashboard-frontend-eu" {
  source                        = "github.com/GoogleCloudPlatform/terraform-google-cloud-run//modules/v2?ref=v0.21.6"
  project_id                    = "alpha-orion"
  location                      = "europe-west1"
  service_name                  = "flash-loan-dashboard-eu"
"container_image" = "us-docker.pkg.dev/alpha-orion/${var.artifact_registry_repo}/flash-loan-dashboard-eu:${lookup(var.image_versions, \"flash-loan-dashboard-eu\", \"latest\")}"
  gpu_zonal_redundancy_disabled = false
  service_account_project_roles = concat(["roles/secretmanager.secretAccessor"], ["roles/alloydb.admin"], ["roles/redis.editor"])
  ingress                       = "INGRESS_TRAFFIC_INTERNAL_LOAD_BALANCER"
  vpc_access = {
    egress = "ALL_TRAFFIC"
    network_interfaces = {
      network    = "default"
      subnetwork = "default"
    }
  }
  cloud_run_deletion_protection = false
  enable_prometheus_sidecar     = true
  volumes                       = []
  service_scaling = {
    min_instance_count = 0
  }
  template_scaling = {
    max_instance_count = 10
    min_instance_count = 1
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "withdrawal-service-eu" {
  source                        = "github.com/GoogleCloudPlatform/terraform-google-cloud-run//modules/v2?ref=v0.21.6"
  project_id                    = "alpha-orion"
  location                      = "europe-west1"
  service_name                  = "withdrawal-service-eu"
"container_image" = "us-docker.pkg.dev/alpha-orion/${var.artifact_registry_repo}/withdrawal-service-eu:${lookup(var.image_versions, \"withdrawal-service-eu\", \"latest\")}"
  gpu_zonal_redundancy_disabled = false
  service_account_project_roles = concat(["roles/secretmanager.secretAccessor"], ["roles/secretmanager.secretAccessor"], ["roles/alloydb.admin"], ["roles/redis.editor"])
  ingress                       = "INGRESS_TRAFFIC_INTERNAL_ONLY"
  vpc_access = {
    egress = "ALL_TRAFFIC"
    network_interfaces = {
      network    = "default"
      subnetwork = "default"
    }
  }
  cloud_run_deletion_protection = false
  enable_prometheus_sidecar     = true
  volumes                       = []
  service_scaling = {
    min_instance_count = 0
  }
  template_scaling = {
    max_instance_count = 10
    min_instance_count = 1
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "ai-terminal-frontend-eu" {
  source                        = "github.com/GoogleCloudPlatform/terraform-google-cloud-run//modules/v2?ref=v0.21.6"
  project_id                    = "alpha-orion"
  location                      = "europe-west1"
  service_name                  = "ai-terminal-frontend-eu"
"container_image" = "us-docker.pkg.dev/alpha-orion/${var.artifact_registry_repo}/ai-terminal-frontend-eu:${lookup(var.image_versions, \"ai-terminal-frontend-eu\", \"latest\")}"
  gpu_zonal_redundancy_disabled = false
  service_account_project_roles = concat(["roles/secretmanager.secretAccessor"], ["roles/alloydb.admin"], ["roles/redis.editor"])
  ingress                       = "INGRESS_TRAFFIC_INTERNAL_LOAD_BALANCER"
  vpc_access = {
    egress = "ALL_TRAFFIC"
    network_interfaces = {
      network    = "default"
      subnetwork = "default"
    }
  }
  cloud_run_deletion_protection = false
  enable_prometheus_sidecar     = true
  volumes                       = []
  service_scaling = {
    min_instance_count = 0
  }
  template_scaling = {
    max_instance_count = 10
    min_instance_count = 1
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "ai-agent-service-eu" {
  source                        = "github.com/GoogleCloudPlatform/terraform-google-cloud-run//modules/v2?ref=v0.21.6"
  project_id                    = "alpha-orion"
  location                      = "europe-west1"
  service_name                  = "ai-agent-service-eu"
"container_image" = "us-docker.pkg.dev/alpha-orion/${var.artifact_registry_repo}/ai-agent-service-eu:${lookup(var.image_versions, \"ai-agent-service-eu\", \"latest\")}"
  gpu_zonal_redundancy_disabled = false
  service_account_project_roles = concat(["roles/aiplatform.user"], ["roles/secretmanager.secretAccessor"], ["roles/alloydb.admin"], ["roles/redis.editor"])
  ingress                       = "INGRESS_TRAFFIC_INTERNAL_ONLY"
  vpc_access = {
    egress = "ALL_TRAFFIC"
    network_interfaces = {
      network    = "default"
      subnetwork = "default"
    }
  }
  cloud_run_deletion_protection = false
  enable_prometheus_sidecar     = true
  volumes                       = []
  service_scaling = {
    min_instance_count = 0
  }
  service_labels = {
    vertex_ai_apis_vertex-ai = "true"
  }
  template_scaling = {
    max_instance_count = 10
    min_instance_count = 1
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "benchmarking-scraper-service-eu" {
  source                        = "github.com/GoogleCloudPlatform/terraform-google-cloud-run//modules/v2?ref=v0.21.6"
  project_id                    = "alpha-orion"
  location                      = "europe-west1"
  service_name                  = "benchmarking-scraper-service-eu"
"container_image" = "us-docker.pkg.dev/alpha-orion/${var.artifact_registry_repo}/benchmarking-scraper-service-eu:${lookup(var.image_versions, \"benchmarking-scraper-service-eu\", \"latest\")}"
  gpu_zonal_redundancy_disabled = false
  service_account_project_roles = concat(["roles/secretmanager.secretAccessor"], ["roles/alloydb.admin"], ["roles/redis.editor"])
  ingress                       = "INGRESS_TRAFFIC_INTERNAL_ONLY"
  vpc_access = {
    egress = "ALL_TRAFFIC"
    network_interfaces = {
      network    = "default"
      subnetwork = "default"
    }
  }
  cloud_run_deletion_protection = false
  enable_prometheus_sidecar     = true
  volumes                       = []
  service_scaling = {
    min_instance_count = 0
  }
  template_scaling = {
    max_instance_count = 50
    min_instance_count = 2
    cpu_utilization_percent = 70
    memory_utilization_percent = 80
    max_concurrency = 1000
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "strategy-engine-service-eu" {
  source                        = "github.com/GoogleCloudPlatform/terraform-google-cloud-run//modules/v2?ref=v0.21.6"
  project_id                    = "alpha-orion"
  location                      = "europe-west1"
  service_name                  = "brain-strategy-engine-eu"
  description                   = "Selects and executes optimal strategies in the EU region."
"container_image" = "us-docker.pkg.dev/alpha-orion/${var.artifact_registry_repo}/brain-strategy-engine-eu:${lookup(var.image_versions, \"brain-strategy-engine-eu\", \"latest\")}"
  gpu_zonal_redundancy_disabled = false
  service_account_project_roles = concat(["roles/secretmanager.secretAccessor"], ["roles/alloydb.admin"], ["roles/redis.editor"])
  ingress                       = "INGRESS_TRAFFIC_INTERNAL_ONLY"
  vpc_access = {
    egress = "ALL_TRAFFIC"
    network_interfaces = {
      network    = "default"
      subnetwork = "default"
    }
  }
  cloud_run_deletion_protection = false
  enable_prometheus_sidecar     = true
  volumes                       = []
  service_scaling = {
    min_instance_count = 0
  }
  template_scaling = {
    max_instance_count = 10
    min_instance_count = 1
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "flash-loan-lb-global-lb-backend-ai-terminal" {
  source                  = "github.com/terraform-google-modules/terraform-google-lb-http//modules/backend?ref=v13.2.0"
  name                    = "flash-loan-app-backend-ai-terminal"
  project_id              = "alpha-orion"
  load_balancing_scheme   = "EXTERNAL_MANAGED"
  protocol                = "HTTP"
  enable_cdn              = true
  serverless_neg_backends = concat([{"region" = module.ai-terminal-frontend.location, "service_name" = module.ai-terminal-frontend.service_name, "service_version" = "", "type" = "cloud-run"}], [{"service_name" = module.ai-terminal-frontend-eu.service_name, "service_version" = "", "type" = "cloud-run", "region" = module.ai-terminal-frontend-eu.location}])
  depends_on              = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "alloydb-primary-us" {
  source     = "github.com/GoogleCloudPlatform/terraform-google-alloy-db?ref=v8.0.1"
  project_id = "alpha-orion"
  cluster_id = "flash-loan-db-us"
  location   = "us-central1"
  cluster_initial_user = {
    password = "YOUR_ALLOYDB_PASSWORD_HERE"
  }
  cluster_encryption_key_name = "projects/alpha-orion/locations/us-central1/keyRings/flash-loan-keyring/cryptoKeys/flash-loan-key"
  automated_backup_policy = {
    enabled                    = true
    time_based_retention_count = "604800s"
  }
  primary_instance = {
    instance_id = "flash-loan-db-us-primary-instance"
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "alloydb-secondary-eu" {
  source                      = "github.com/GoogleCloudPlatform/terraform-google-alloy-db?ref=v8.0.1"
  project_id                  = "alpha-orion"
  cluster_id                  = "flash-loan-db-eu"
  cluster_type                = "SECONDARY"
  location                    = "europe-west1"
  cluster_encryption_key_name = "projects/alpha-orion/locations/europe-west1/keyRings/flash-loan-keyring-eu/cryptoKeys/flash-loan-key-eu"
  automated_backup_policy = {
    enabled                    = true
    time_based_retention_count = "604800s"
  }
  primary_instance = {
    instance_id = "flash-loan-db-eu-primary-instance"
  }
  primary_cluster_name = "projects/alpha-orion/locations/us-central1/clusters/flash-loan-db-us"
  depends_on           = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "redis-cache-us" {
  source                  = "github.com/terraform-google-modules/terraform-google-memorystore?ref=v15.2.1"
  project_id              = "alpha-orion"
  region                  = "us-central1"
  name                    = "flash-loan-redis-us"
  memory_size_gb          = 16
  redis_version           = "REDIS_7_2"
  connect_mode            = "DIRECT_PEERING"
  read_replicas_mode      = "READ_REPLICAS_ENABLED"
  replica_count           = 1
  auth_enabled            = true
  transit_encryption_mode = "DISABLED"
  customer_managed_key    = "projects/alpha-orion/locations/us-central1/keyRings/flash-loan-keyring/cryptoKeys/flash-loan-key"
  persistence_config = {
    persistence_mode    = "RDB"
    rdb_snapshot_period = "ONE_HOUR"
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "redis-cache-eu" {
  source                  = "github.com/terraform-google-modules/terraform-google-memorystore?ref=v15.2.1"
  project_id              = "alpha-orion"
  region                  = "europe-west1"
  name                    = "flash-loan-redis-eu"
  memory_size_gb          = 16
  redis_version           = "REDIS_7_2"
  connect_mode            = "DIRECT_PEERING"
  read_replicas_mode      = "READ_REPLICAS_ENABLED"
  replica_count           = 1
  auth_enabled            = true
  transit_encryption_mode = "DISABLED"
  customer_managed_key    = "projects/alpha-orion/locations/europe-west1/keyRings/flash-loan-keyring-eu/cryptoKeys/flash-loan-key-eu"
  persistence_config = {
    persistence_mode    = "RDB"
    rdb_snapshot_period = "ONE_HOUR"
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "market-data-lake" {
  source     = "github.com/terraform-google-modules/terraform-google-cloud-storage//modules/simple_bucket?ref=v12.0.0"
  project_id = "alpha-orion"
  location   = var.market-data-lake_location
  name       = "alpha-orion-market-data-lake"
  iam_members = [{
    member = module.scanner-service-data-analysis.service_account_id.member
    role   = "roles/storage.objectAdmin"
  }]
  storage_class = "STANDARD"
  encryption = {
    default_kms_key_name = "projects/alpha-orion/locations/us-central1/keyRings/flash-loan-keyring/cryptoKeys/flash-loan-key"
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "historical-data-warehouse" {
  source         = "github.com/terraform-google-modules/terraform-google-bigquery?ref=v10.2.1"
  dataset_id     = "flash_loan_historical_data"
  description    = "BigQuery dataset for flash loan historical data, leveraging BigQuery ML for predictive modeling, pattern identification, and anomaly detection."
  project_id     = "alpha-orion"
  encryption_key = "projects/alpha-orion/locations/us-central1/keyRings/flash-loan-keyring/cryptoKeys/flash-loan-key"
  tables         = [{"schema" = "[{\"description\": \"A string type unique identifier\",\"mode\": \"NULLABLE\",\"name\": \"simpleId\",\"type\": \"STRING\"},{\"description\": \"A field to hold integer values\",\"mode\": \"NULLABLE\",\"name\": \"integerField\",\"type\": \"INTEGER\"},{\"description\": \"Data\",\"mode\": \"NULLABLE\",\"name\": \"data\",\"type\": \"STRING\"}]", "table_id" = "table-1"}]
  depends_on     = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "order-management-service-us" {
  source                        = "github.com/GoogleCloudPlatform/terraform-google-cloud-run//modules/v2?ref=v0.21.6"
  project_id                    = "alpha-orion"
  location                      = "us-central1"
  service_name                  = "order-management-service-us"
"container_image" = "us-docker.pkg.dev/alpha-orion/${var.artifact_registry_repo}/order-management-service-us:${lookup(var.image_versions, \"order-management-service-us\", \"latest\")}"
  gpu_zonal_redundancy_disabled = false
  service_account_project_roles = concat(["roles/alloydb.admin"], ["roles/redis.editor"])
  ingress                       = "INGRESS_TRAFFIC_INTERNAL_ONLY"
  vpc_access = {
    egress = "ALL_TRAFFIC"
    network_interfaces = {
      network    = "default"
      subnetwork = "default"
    }
  }
  cloud_run_deletion_protection = false
  enable_prometheus_sidecar     = true
  volumes                       = []
  service_scaling = {
    min_instance_count = 0
  }
  template_scaling = {
    max_instance_count = 10
    min_instance_count = 1
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "order-management-service-eu" {
  source                        = "github.com/GoogleCloudPlatform/terraform-google-cloud-run//modules/v2?ref=v0.21.6"
  project_id                    = "alpha-orion"
  location                      = "europe-west1"
  service_name                  = "order-management-service-eu"
"container_image" = "us-docker.pkg.dev/alpha-orion/${var.artifact_registry_repo}/order-management-service-eu:${lookup(var.image_versions, \"order-management-service-eu\", \"latest\")}"
  gpu_zonal_redundancy_disabled = false
  service_account_project_roles = concat(["roles/alloydb.admin"], ["roles/redis.editor"])
  ingress                       = "INGRESS_TRAFFIC_INTERNAL_ONLY"
  vpc_access = {
    egress = "ALL_TRAFFIC"
    network_interfaces = {
      network    = "default"
      subnetwork = "default"
    }
  }
  cloud_run_deletion_protection = false
  enable_prometheus_sidecar     = true
  volumes                       = []
  service_scaling = {
    min_instance_count = 0
  }
  template_scaling = {
    max_instance_count = 10
    min_instance_count = 1
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "risk-management-service-us" {
  source                        = "github.com/GoogleCloudPlatform/terraform-google-cloud-run//modules/v2?ref=v0.21.6"
  project_id                    = "alpha-orion"
  location                      = "us-central1"
  service_name                  = "brain-risk-management-us"
  description                   = "Assesses and manages risks associated with flash loans in the US region."
"container_image" = "us-docker.pkg.dev/alpha-orion/${var.artifact_registry_repo}/brain-risk-management-us:${lookup(var.image_versions, \"brain-risk-management-us\", \"latest\")}"
  gpu_zonal_redundancy_disabled = false
  service_account_project_roles = concat(["roles/alloydb.admin"], ["roles/redis.editor"])
  ingress                       = "INGRESS_TRAFFIC_INTERNAL_ONLY"
  vpc_access = {
    egress = "ALL_TRAFFIC"
    network_interfaces = {
      network    = "default"
      subnetwork = "default"
    }
  }
  cloud_run_deletion_protection = false
  enable_prometheus_sidecar     = true
  volumes                       = []
  service_scaling = {
    min_instance_count = 0
  }
  template_scaling = {
    max_instance_count = 10
    min_instance_count = 1
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "risk-management-service-eu" {
  source                        = "github.com/GoogleCloudPlatform/terraform-google-cloud-run//modules/v2?ref=v0.21.6"
  project_id                    = "alpha-orion"
  location                      = "europe-west1"
  service_name                  = "brain-risk-management-eu"
  description                   = "Assesses and manages risks associated with flash loans in the EU region."
"container_image" = "us-docker.pkg.dev/alpha-orion/${var.artifact_registry_repo}/brain-risk-management-eu:${lookup(var.image_versions, \"brain-risk-management-eu\", \"latest\")}"
  gpu_zonal_redundancy_disabled = false
  service_account_project_roles = concat(["roles/alloydb.admin"], ["roles/redis.editor"])
  ingress                       = "INGRESS_TRAFFIC_INTERNAL_ONLY"
  vpc_access = {
    egress = "ALL_TRAFFIC"
    network_interfaces = {
      network    = "default"
      subnetwork = "default"
    }
  }
  cloud_run_deletion_protection = false
  enable_prometheus_sidecar     = true
  volumes                       = []
  service_scaling = {
    min_instance_count = 0
  }
  template_scaling = {
    max_instance_count = 10
    min_instance_count = 1
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "flash-loan-bigtable" {
  source     = "github.com/GoogleCloudPlatform/terraform-google-bigtable?ref=v0.4.1"
  project_id = "alpha-orion"
  name       = "flash-loan-bigtable"
  zones = {
    europe-west1-b = {
      autoscaling_config = {
        cpu_target = 60
        max_nodes  = 3
        min_nodes  = 1
      }
      cluster_id = "flash-loan-bigtable-eu"
      zone       = "europe-west1-b"
    }
    us-central1-a = {
      autoscaling_config = {
        cpu_target = 60
        max_nodes  = 3
        min_nodes  = 1
      }
      cluster_id = "flash-loan-bigtable-us"
      zone       = "us-central1-a"
    }
  }
  tables = {
    table1 = {
      table_name = "table-1"
    }
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "dataflow-market-data-ingestion-us" {
  source                        = "github.com/GoogleCloudPlatform/terraform-google-cloud-run//modules/v2?ref=v0.21.6"
  project_id                    = "alpha-orion"
  location                      = "us-central1"
  service_name                  = "dataflow-market-data-ingestion-us"
  description                   = "Cloud Dataflow job (represented as Cloud Run) for real-time market data ingestion into BigQuery and Bigtable."
"container_image" = "us-docker.pkg.dev/alpha-orion/${var.artifact_registry_repo}/dataflow-market-data-ingestion-us:${lookup(var.image_versions, \"dataflow-market-data-ingestion-us\", \"latest\")}"
  gpu_zonal_redundancy_disabled = false
  service_account_project_roles = ["roles/bigtable.admin"]
  ingress                       = "INGRESS_TRAFFIC_INTERNAL_ONLY"
  vpc_access = {
    egress = "ALL_TRAFFIC"
    network_interfaces = {
      network    = "default"
      subnetwork = "default"
    }
  }
  cloud_run_deletion_protection = false
  enable_prometheus_sidecar     = true
  volumes                       = []
  service_scaling = {
    min_instance_count = 0
  }
  template_scaling = {
    max_instance_count = 10
    min_instance_count = 1
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "dataflow-market-data-ingestion-eu" {
  source                        = "github.com/GoogleCloudPlatform/terraform-google-cloud-run//modules/v2?ref=v0.21.6"
  project_id                    = "alpha-orion"
  location                      = "europe-west1"
  service_name                  = "dataflow-market-data-ingestion-eu"
  description                   = "Cloud Dataflow job (represented as Cloud Run) for real-time market data ingestion into BigQuery and Bigtable."
"container_image" = "us-docker.pkg.dev/alpha-orion/${var.artifact_registry_repo}/dataflow-market-data-ingestion-eu:${lookup(var.image_versions, \"dataflow-market-data-ingestion-eu\", \"latest\")}"
  gpu_zonal_redundancy_disabled = false
  service_account_project_roles = ["roles/bigtable.admin"]
  ingress                       = "INGRESS_TRAFFIC_INTERNAL_ONLY"
  vpc_access = {
    egress = "ALL_TRAFFIC"
    network_interfaces = {
      network    = "default"
      subnetwork = "default"
    }
  }
  cloud_run_deletion_protection = false
  enable_prometheus_sidecar     = true
  volumes                       = []
  service_scaling = {
    min_instance_count = 0
  }
  template_scaling = {
    max_instance_count = 10
    min_instance_count = 1
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "dataflow-cep-us" {
  source                        = "github.com/GoogleCloudPlatform/terraform-google-cloud-run//modules/v2?ref=v0.21.6"
  project_id                    = "alpha-orion"
  location                      = "us-central1"
  service_name                  = "dataflow-cep-us"
  description                   = "Cloud Dataflow job (represented as Cloud Run) for complex event processing of raw opportunities."
"container_image" = "us-docker.pkg.dev/alpha-orion/${var.artifact_registry_repo}/dataflow-cep-us:${lookup(var.image_versions, \"dataflow-cep-us\", \"latest\")}"
  gpu_zonal_redundancy_disabled = false
  ingress                       = "INGRESS_TRAFFIC_INTERNAL_ONLY"
  vpc_access = {
    egress = "ALL_TRAFFIC"
    network_interfaces = {
      network    = "default"
      subnetwork = "default"
    }
  }
  cloud_run_deletion_protection = false
  enable_prometheus_sidecar     = true
  volumes                       = []
  service_scaling = {
    min_instance_count = 0
  }
  template_scaling = {
    max_instance_count = 10
    min_instance_count = 1
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "dataflow-cep-eu" {
  source                        = "github.com/GoogleCloudPlatform/terraform-google-cloud-run//modules/v2?ref=v0.21.6"
  project_id                    = "alpha-orion"
  location                      = "europe-west1"
  service_name                  = "dataflow-cep-eu"
  description                   = "Cloud Dataflow job (represented as Cloud Run) for complex event processing of raw opportunities."
"container_image" = "us-docker.pkg.dev/alpha-orion/${var.artifact_registry_repo}/dataflow-cep-eu:${lookup(var.image_versions, \"dataflow-cep-eu\", \"latest\")}"
  gpu_zonal_redundancy_disabled = false
  ingress                       = "INGRESS_TRAFFIC_INTERNAL_ONLY"
  vpc_access = {
    egress = "ALL_TRAFFIC"
    network_interfaces = {
      network    = "default"
      subnetwork = "default"
    }
  }
  cloud_run_deletion_protection = false
  enable_prometheus_sidecar     = true
  volumes                       = []
  service_scaling = {
    min_instance_count = 0
  }
  template_scaling = {
    max_instance_count = 10
    min_instance_count = 1
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "processed-opportunities-us" {
  source     = "github.com/terraform-google-modules/terraform-google-pubsub?ref=v8.3.2"
  project_id = "alpha-orion"
  topic      = "processed-opportunities-us"
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "processed-opportunities-eu" {
  source     = "github.com/terraform-google-modules/terraform-google-pubsub?ref=v8.3.2"
  project_id = "alpha-orion"
  topic      = "processed-opportunities-eu"
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "blockchain-node-proxy-service-us" {
  source                        = "github.com/GoogleCloudPlatform/terraform-google-cloud-run//modules/v2?ref=v0.21.6"
  project_id                    = "alpha-orion"
  location                      = "us-central1"
  service_name                  = "hand-blockchain-proxy-us"
  description                   = "Proxies communication with blockchain nodes for transaction settlement in the US region."
"container_image" = "us-docker.pkg.dev/alpha-orion/${var.artifact_registry_repo}/hand-blockchain-proxy-us:${lookup(var.image_versions, \"hand-blockchain-proxy-us\", \"latest\")}"
  gpu_zonal_redundancy_disabled = false
  ingress                       = "INGRESS_TRAFFIC_INTERNAL_ONLY"
  vpc_access = {
    egress = "ALL_TRAFFIC"
    network_interfaces = {
      network    = "default"
      subnetwork = "default"
    }
  }
  cloud_run_deletion_protection = false
  enable_prometheus_sidecar     = true
  volumes                       = []
  service_scaling = {
    min_instance_count = 0
  }
  template_scaling = {
    max_instance_count = 10
    min_instance_count = 1
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "blockchain-node-proxy-service-eu" {
  source                        = "github.com/GoogleCloudPlatform/terraform-google-cloud-run//modules/v2?ref=v0.21.6"
  project_id                    = "alpha-orion"
  location                      = "europe-west1"
  service_name                  = "hand-blockchain-proxy-eu"
  description                   = "Proxies communication with blockchain nodes for transaction settlement in the EU region."
"container_image" = "us-docker.pkg.dev/alpha-orion/${var.artifact_registry_repo}/hand-blockchain-proxy-eu:${lookup(var.image_versions, \"hand-blockchain-proxy-eu\", \"latest\")}"
  gpu_zonal_redundancy_disabled = false
  ingress                       = "INGRESS_TRAFFIC_INTERNAL_ONLY"
  vpc_access = {
    egress = "ALL_TRAFFIC"
    network_interfaces = {
      network    = "default"
      subnetwork = "default"
    }
  }
  cloud_run_deletion_protection = false
  enable_prometheus_sidecar     = true
  volumes                       = []
  service_scaling = {
    min_instance_count = 0
  }
  template_scaling = {
    max_instance_count = 10
    min_instance_count = 1
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "smart-order-router-service-us" {
  source                        = "github.com/GoogleCloudPlatform/terraform-google-cloud-run//modules/v2?ref=v0.21.6"
  project_id                    = "alpha-orion"
  location                      = "us-central1"
  service_name                  = "hand-smart-order-router-us"
  description                   = "Routes orders intelligently for optimal execution in the US region."
"container_image" = "us-docker.pkg.dev/alpha-orion/${var.artifact_registry_repo}/hand-smart-order-router-us:${lookup(var.image_versions, \"hand-smart-order-router-us\", \"latest\")}"
  gpu_zonal_redundancy_disabled = false
  service_account_project_roles = ["roles/run.invoker"]
  ingress                       = "INGRESS_TRAFFIC_INTERNAL_ONLY"
  vpc_access = {
    egress = "ALL_TRAFFIC"
    network_interfaces = {
      network    = "default"
      subnetwork = "default"
    }
  }
  cloud_run_deletion_protection = false
  enable_prometheus_sidecar     = true
  volumes                       = []
  service_scaling = {
    min_instance_count = 0
  }
  template_scaling = {
    max_instance_count = 10
    min_instance_count = 1
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "smart-order-router-service-eu" {
  source                        = "github.com/GoogleCloudPlatform/terraform-google-cloud-run//modules/v2?ref=v0.21.6"
  project_id                    = "alpha-orion"
  location                      = "europe-west1"
  service_name                  = "hand-smart-order-router-eu"
  description                   = "Routes orders intelligently for optimal execution in the EU region."
"container_image" = "us-docker.pkg.dev/alpha-orion/${var.artifact_registry_repo}/hand-smart-order-router-eu:${lookup(var.image_versions, \"hand-smart-order-router-eu\", \"latest\")}"
  gpu_zonal_redundancy_disabled = false
  service_account_project_roles = ["roles/run.invoker"]
  ingress                       = "INGRESS_TRAFFIC_INTERNAL_ONLY"
  vpc_access = {
    egress = "ALL_TRAFFIC"
    network_interfaces = {
      network    = "default"
      subnetwork = "default"
    }
  }
  cloud_run_deletion_protection = false
  enable_prometheus_sidecar     = true
  volumes                       = []
  service_scaling = {
    min_instance_count = 0
  }
  template_scaling = {
    max_instance_count = 10
    min_instance_count = 1
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "ai-optimization-orchestrator-us" {
  source                        = "github.com/GoogleCloudPlatform/terraform-google-cloud-run//modules/v2?ref=v0.21.6"
  project_id                    = "alpha-orion"
  location                      = "us-central1"
  service_name                  = "brain-ai-optimization-orchestrator-us"
  description                   = "Orchestrates the continuous AI optimization loop in the US region."
"container_image" = "us-docker.pkg.dev/alpha-orion/${var.artifact_registry_repo}/brain-ai-optimization-orchestrator-us:${lookup(var.image_versions, \"brain-ai-optimization-orchestrator-us\", \"latest\")}"
  gpu_zonal_redundancy_disabled = false
  service_account_project_roles = concat(["roles/aiplatform.user"], ["roles/run.invoker"])
  ingress                       = "INGRESS_TRAFFIC_INTERNAL_ONLY"
  vpc_access = {
    egress = "ALL_TRAFFIC"
    network_interfaces = {
      network    = "default"
      subnetwork = "default"
    }
  }
  cloud_run_deletion_protection = false
  enable_prometheus_sidecar     = true
  service_scaling = {
    min_instance_count = 0
  }
  service_labels = {
    vertex_ai_apis_vertex-ai = "true"
  }
  template_scaling = {
    max_instance_count = 10
    min_instance_count = 1
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "ai-optimization-orchestrator-eu" {
  source                        = "github.com/GoogleCloudPlatform/terraform-google-cloud-run//modules/v2?ref=v0.21.6"
  project_id                    = "alpha-orion"
  location                      = "europe-west1"
  service_name                  = "brain-ai-optimization-orchestrator-eu"
  description                   = "Orchestrates the continuous AI optimization loop in the EU region."
"container_image" = "us-docker.pkg.dev/alpha-orion/${var.artifact_registry_repo}/brain-ai-optimization-orchestrator-eu:${lookup(var.image_versions, \"brain-ai-optimization-orchestrator-eu\", \"latest\")}"
  gpu_zonal_redundancy_disabled = false
  service_account_project_roles = concat(["roles/aiplatform.user"], ["roles/run.invoker"])
  ingress                       = "INGRESS_TRAFFIC_INTERNAL_ONLY"
  vpc_access = {
    egress = "ALL_TRAFFIC"
    network_interfaces = {
      network    = "default"
      subnetwork = "default"
    }
  }
  cloud_run_deletion_protection = false
  enable_prometheus_sidecar     = true
  service_scaling = {
    min_instance_count = 0
  }
  service_labels = {
    vertex_ai_apis_vertex-ai = "true"
  }
  template_scaling = {
    max_instance_count = 10
    min_instance_count = 1
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "simulation-service-us" {
  source                        = "github.com/GoogleCloudPlatform/terraform-google-cloud-run//modules/v2?ref=v0.21.6"
  project_id                    = "alpha-orion"
  location                      = "us-central1"
  service_name                  = "brain-simulation-us"
  description                   = "Simulates flash loan scenarios for strategy validation and optimization in the US region."
"container_image" = "us-docker.pkg.dev/alpha-orion/${var.artifact_registry_repo}/brain-simulation-us:${lookup(var.image_versions, \"brain-simulation-us\", \"latest\")}"
  gpu_zonal_redundancy_disabled = false
  ingress                       = "INGRESS_TRAFFIC_INTERNAL_ONLY"
  vpc_access = {
    egress = "ALL_TRAFFIC"
    network_interfaces = {
      network    = "default"
      subnetwork = "default"
    }
  }
  cloud_run_deletion_protection = false
  enable_prometheus_sidecar     = true
  service_scaling = {
    min_instance_count = 0
  }
  template_scaling = {
    max_instance_count = 10
    min_instance_count = 1
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "simulation-service-eu" {
  source                        = "github.com/GoogleCloudPlatform/terraform-google-cloud-run//modules/v2?ref=v0.21.6"
  project_id                    = "alpha-orion"
  location                      = "europe-west1"
  service_name                  = "brain-simulation-eu"
  description                   = "Simulates flash loan scenarios for strategy validation and optimization in the EU region."
"container_image" = "us-docker.pkg.dev/alpha-orion/${var.artifact_registry_repo}/brain-simulation-eu:${lookup(var.image_versions, \"brain-simulation-eu\", \"latest\")}"
  gpu_zonal_redundancy_disabled = false
  ingress                       = "INGRESS_TRAFFIC_INTERNAL_ONLY"
  vpc_access = {
    egress = "ALL_TRAFFIC"
    network_interfaces = {
      network    = "default"
      subnetwork = "default"
    }
  }
  cloud_run_deletion_protection = false
  enable_prometheus_sidecar     = true
  service_scaling = {
    min_instance_count = 0
  }
  template_scaling = {
    max_instance_count = 10
    min_instance_count = 1
  }
  depends_on = [module.project-services-alpha-orion, module.project-services-billing-project]
}
module "apphub" {
  source         = "github.com/GoogleCloudPlatform/terraform-google-apphub?ref=v0.4.0"
  project_id     = var.apphub_project_id
  location       = var.apphub_location
  service_uris   = concat([module.user-api-service.apphub_service_uri], [module.scanner-service-data-analysis.apphub_service_uri], [module.orchestrator-service.apphub_service_uri], [module.ai-optimizer-service.apphub_service_uri], [module.dashboard-frontend.apphub_service_uri], [module.withdrawal-service.apphub_service_uri], [module.ai-terminal-frontend.apphub_service_uri], [module.ai-agent-service.apphub_service_uri], [module.benchmarking-scraper-service.apphub_service_uri], [module.strategy-engine-service.apphub_service_uri], module.flash-loan-lb-global-lb-frontend.apphub_service_uri, module.flash-loan-lb-global-lb-backend.apphub_service_uri, [module.user-api-service-eu.apphub_service_uri], [module.scanner-service-data-analysis-eu.apphub_service_uri], [module.orchestrator-service-eu.apphub_service_uri], [module.ai-optimizer-service-eu.apphub_service_uri], [module.dashboard-frontend-eu.apphub_service_uri], [module.withdrawal-service-eu.apphub_service_uri], [module.ai-terminal-frontend-eu.apphub_service_uri], [module.ai-agent-service-eu.apphub_service_uri], [module.benchmarking-scraper-service-eu.apphub_service_uri], [module.strategy-engine-service-eu.apphub_service_uri], module.flash-loan-lb-global-lb-backend-ai-terminal.apphub_service_uri, [module.redis-cache-us.apphub_service_uri], [module.redis-cache-eu.apphub_service_uri], [module.market-data-lake.apphub_service_uri], [module.order-management-service-us.apphub_service_uri], [module.order-management-service-eu.apphub_service_uri], [module.risk-management-service-us.apphub_service_uri], [module.risk-management-service-eu.apphub_service_uri], [module.dataflow-market-data-ingestion-us.apphub_service_uri], [module.dataflow-market-data-ingestion-eu.apphub_service_uri], [module.dataflow-cep-us.apphub_service_uri], [module.dataflow-cep-eu.apphub_service_uri], [module.blockchain-node-proxy-service-us.apphub_service_uri], [module.blockchain-node-proxy-service-eu.apphub_service_uri], [module.smart-order-router-service-us.apphub_service_uri], [module.smart-order-router-service-eu.apphub_service_uri], [module.ai-optimization-orchestrator-us.apphub_service_uri], [module.ai-optimization-orchestrator-eu.apphub_service_uri], [module.simulation-service-us.apphub_service_uri], [module.simulation-service-eu.apphub_service_uri])
  application_id = var.apphub_application_id
}
module "project-services-alpha-orion" {
  source                      = "github.com/terraform-google-modules/terraform-google-project-factory//modules/project_services?ref=v18.2.0"
  project_id                  = "alpha-orion"
  disable_services_on_destroy = false
  activate_apis               = ["accesscontextmanager.googleapis.com", "admin.googleapis.com", "alloydb.googleapis.com", "appengine.googleapis.com", "bigquery.googleapis.com", "bigquerystorage.googleapis.com", "bigtable.googleapis.com", "bigtableadmin.googleapis.com", "billingbudgets.googleapis.com", "certificatemanager.googleapis.com", "cloudbilling.googleapis.com", "cloudkms.googleapis.com", "cloudresourcemanager.googleapis.com", "compute.googleapis.com", "dns.googleapis.com", "essentialcontacts.googleapis.com", "iam.googleapis.com", "iamcredentials.googleapis.com", "iap.googleapis.com", "memcache.googleapis.com", "monitoring.googleapis.com", "oslogin.googleapis.com", "pubsub.googleapis.com", "redis.googleapis.com", "run.googleapis.com", "secretmanager.googleapis.com", "serviceconsumermanagement.googleapis.com", "servicedirectory.googleapis.com", "servicenetworking.googleapis.com", "serviceusage.googleapis.com", "storage-api.googleapis.com", "storage.googleapis.com", "vpcaccess.googleapis.com"]
}
module "project-services-billing-project" {
  source                      = "github.com/terraform-google-modules/terraform-google-project-factory//modules/project_services?ref=v18.2.0"
  project_id                  = "alpha-orion"
  disable_services_on_destroy = false
  activate_apis               = ["accesscontextmanager.googleapis.com", "admin.googleapis.com", "alloydb.googleapis.com", "appengine.googleapis.com", "apphub.googleapis.com", "bigquery.googleapis.com", "bigquerystorage.googleapis.com", "bigtable.googleapis.com", "bigtableadmin.googleapis.com", "billingbudgets.googleapis.com", "certificatemanager.googleapis.com", "cloudbilling.googleapis.com", "cloudkms.googleapis.com", "cloudresourcemanager.googleapis.com", "compute.googleapis.com", "dns.googleapis.com", "essentialcontacts.googleapis.com", "iam.googleapis.com", "iamcredentials.googleapis.com", "iap.googleapis.com", "memcache.googleapis.com", "monitoring.googleapis.com", "oslogin.googleapis.com", "pubsub.googleapis.com", "redis.googleapis.com", "run.googleapis.com", "secretmanager.googleapis.com", "serviceconsumermanagement.googleapis.com", "servicedirectory.googleapis.com", "servicenetworking.googleapis.com", "serviceusage.googleapis.com", "storage-api.googleapis.com", "storage.googleapis.com", "vpcaccess.googleapis.com"]
}
