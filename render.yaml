# Alpha-Orion Complete Render Deployment Configuration
# Version: 3.0 - DASHBOARD AS PRIMARY SERVICE
# The main URL will serve the dashboard frontend

services:
  # ============================================================
  # DASHBOARD (React Frontend) - PRIMARY SERVICE
  # This serves at the main URL: alpha-orion.onrender.com
  # ============================================================
  - type: web
    name: alpha-orion
    env: node
    nodeVersion: 18
    buildCommand: cd dashboard && npm install && npm run build
    startCommand: npx serve -s dist -l $PORT
    envVars:
      - key: NODE_VERSION
        value: "18"
      - key: VITE_API_URL
        sync: false
      - key: VITE_WS_URL
        sync: false
    healthCheckPath: /
    autoscaling:
      enabled: true
      minInstances: 1
      maxInstances: 3

  # ============================================================
  # OPTIONAL: BACKEND API SERVICE
  # Uncomment if you need backend API for profit generation
  # ============================================================
  # - type: web
  #   name: alpha-orion-api
  #   env: node
  #   nodeVersion: 18
  #   buildCommand: cd backend-services/services/user-api-service && npm install
  #   startCommand: cd backend-services/services/user-api-service && npm start
  #   envVars:
  #     - key: PORT
  #       value: 8080
  #     - key: DATABASE_URL
  #       fromDatabase:
  #         name: alpha-orion-db
  #         property: connectionString
  #     - key: REDIS_URL
  #       fromService:
  #         type: redis
  #         name: alpha-orion-redis
  #         property: connectionString
  #     - key: OPENAI_API_KEY
  #       sync: false
  #   healthCheckPath: /health

# ============================================================
# DATABASES (Optional - only needed if using backend)
# ============================================================

# databases:
#   - name: alpha-orion-db
#     databaseName: alphaorion
#     user: alpha_user
#     plan: starter

# ============================================================
# REDIS (Optional - only needed if using backend)
# ============================================================

# redis:
#   - name: alpha-orion-redis
#     ipAllowList: []
#     plan: starter

# ============================================================
# ENVIRONMENT GROUPS
# ============================================================

envVarGroups:
  - name: alpha-orion-config
    envVars:
      - key: ENVIRONMENT
        value: production
      - key: LOG_LEVEL
        value: INFO

  - name: alpha-orion-secrets
    envVars:
      - key: VITE_API_URL
        sync: false
      - key: OPENAI_API_KEY
        sync: false
